(()=>{async function e(){}function t(e){let{spriteIndex:t,spriteSheet:a,name:s,stats:n,behavior:o,talkTrigger:r,stepTrigger:i,dropLevel:l,facing:c,talkPortrait:h,actorType:u}=Object.assign(Object.assign({},Na),e);return[t,a,s,n,o,r,i,l,c,h,u]}function a(e){return t(Object.assign(Object.assign({},e),{name:"",spriteSheet:"actors1",actorType:1}))}function s(e){return t(Object.assign(Object.assign({spriteIndex:da.Sign},e),{name:"Sign",spriteSheet:"actors1",actorType:3,talkTrigger:()=>{(e=>{let t=ha();t.visible=!0,t.text=e.text,t.portrait=e.portrait,t.title=e.title||"ALERT",t.cb=e.cb,void 0!==e.soundName?e.soundName&&Qa(e.soundName):Qa("alert"),hs()})({text:e.text,portrait:ya.Sign,title:"SIGN",soundName:"alertMinor"})}}))}let n=e=>{let t=[];for(let a in e)t.push(`${a}:${e[a]}`);return t.join(";")},o=(e,t)=>{le(e,t)},r=function(e,t){var a;let s=[],o=null==t?void 0:t.style;o&&(t.style=n(o));let r=Array.prototype.slice.call(arguments,2);for(let e=0;e<r.length;e++){let t=r[e];if("string"==typeof t)s.push(re(t));else if(void 0!==(null===(a=t)||void 0===a?void 0:a.length))for(let e=0;e<t.length;e++)t[e]&&s.push(t[e]);else{if(!t.type)throw Error("Invalid child provided to superfine: "+JSON.stringify(t));s.push(t)}}return ie(e,t||{},s)};e();let i=function(e){let t={},a={};return t["main.json"]=e=>(U.set("curIN2f","main.json"),a.WpSRz=()=>{U.set("curIN2n","WpSRz"),a.Ft2T4()},a.Ft2T4=()=>{U.set("lasIN2f",U.get("curIN2f"));let e=t.NONE;e?e():q.exit()},void 0===e?a.WpSRz():e&&a[e](),U.state),t["Alinea_CH_Sol.json"]=e=>(U.set("curIN2f","Alinea_CH_Sol.json"),a.LtObD=()=>{U.set("curIN2n","LtObD"),U.once()?a.kzGPw():a.cafB3()},a.kzGPw=()=>{U.set("curIN2n","kzGPw"),q.say("A hooded man leans against a tree, and stares blankly out at the ocean.  Something about his stillness is unnerving.  You have the impression he has been here for quite some time, almost like he is part of the tree he leans against.",a.IUz5L)},a.IUz5L=()=>{U.set("curIN2n","IUz5L"),q.choose("","IUz5L",[{t:"Hey... what are you doing?",cb:a.EaRdf,c:()=>!0},{t:"Hey!  Would you mind answering the question?",cb:a.kZA14,c:()=>U.get("nodes.EaRdf")},{t:"*Approach him and grab his shoulder.*",cb:a.pCxIY,c:()=>U.get("nodes.kZA14")},{t:"Sheesh, what's your problem?",cb:a.DAHzS,c:()=>U.get("nodes.pCxIY")},{t:"Nevermind.",cb:a.tG08a,c:()=>!0}])},a.EaRdf=()=>{U.set("curIN2n","EaRdf"),q.say("He doesn't respond, and in fact, completely ignores you.",a.IUz5L)},a.kZA14=()=>{U.set("curIN2n","kZA14"),q.say("Again, he ignores you.",a.IUz5L)},a.pCxIY=()=>{U.set("curIN2n","pCxIY"),q.say("The moment you take your first step towards him, he sharply turns his head.  Sharp eyes blaze beneath his hood, and an intense, murderous gaze halts your step.  He opens his mouth to speak in a croaking rasp.",a.awd6F)},a.awd6F=()=>{U.set("curIN2n","awd6F"),q.say('"Do not test my patience.  Leave me alone."',a.IUz5L)},a.DAHzS=()=>{U.set("curIN2n","DAHzS"),q.say("Unsurprisingly, your question is met with further silence.  He turns to face the ocean once again.",a.IUz5L)},a.tG08a=()=>{U.set("lasIN2f",U.get("curIN2f"));let e=t.NONE;e?e():q.exit()},a.cafB3=()=>{U.set("curIN2n","cafB3"),q.say("This hooded man is still standing here, staring at the ocean.",a.IUz5L)},void 0===e?a.LtObD():e&&a[e](),U.state),t["Alinea_CH_Idoreo.json"]=e=>(U.set("curIN2f","Alinea_CH_Idoreo.json"),a.FdbAF=()=>{U.set("lasIN2f",U.get("curIN2f"));let e=t.NONE;e?e():q.exit()},void 0===e?a.FdbAF():e&&a[e](),U.state),t["Alinea_CH_SirLavolanChevel.json"]=e=>(U.set("curIN2f","Alinea_CH_SirLavolanChevel.json"),a.r7TWk=()=>{U.set("lasIN2f",U.get("curIN2f"));let e=t.NONE;e?e():q.exit()},void 0===e?a.r7TWk():e&&a[e](),U.state),t["Alinea_CH_RadmilaOmvaire.json"]=e=>(U.set("curIN2f","Alinea_CH_RadmilaOmvaire.json"),a.KxZH3=()=>{U.set("lasIN2f",U.get("curIN2f"));let e=t.NONE;e?e():q.exit()},void 0===e?a.KxZH3():e&&a[e](),U.state),t["Alinea_CH_Igmund.json"]=e=>(U.set("curIN2f","Alinea_CH_Igmund.json"),a.iPi3f=()=>{U.set("lasIN2f",U.get("curIN2f"));let e=t.NONE;e?e():q.exit()},void 0===e?a.iPi3f():e&&a[e](),U.state),t["Alinea_CH_Gruff.json"]=e=>(U.set("curIN2f","Alinea_CH_Gruff.json"),a.f1zni=()=>{U.set("lasIN2f",U.get("curIN2f"));let e=t.NONE;e?e():q.exit()},void 0===e?a.f1zni():e&&a[e](),U.state),t["Alinea_CH_Elvyosa.json"]=e=>(U.set("curIN2f","Alinea_CH_Elvyosa.json"),a.m8Gsl=()=>{U.set("lasIN2f",U.get("curIN2f"));let e=t.NONE;e?e():q.exit()},void 0===e?a.m8Gsl():e&&a[e](),U.state),t["Alinea_CH_DunnsMurose.json"]=e=>(U.set("curIN2f","Alinea_CH_DunnsMurose.json"),a.YDiFN=()=>{U.set("lasIN2f",U.get("curIN2f"));let e=t.NONE;e?e():q.exit()},void 0===e?a.YDiFN():e&&a[e](),U.state),t["Alinea_CH_DockmasterClaire.json"]=e=>(U.set("curIN2f","Alinea_CH_DockmasterClaire.json"),a.G2sLG=()=>{U.set("curIN2n","G2sLG"),U.once()?a.XgRzi():a.BgtJr()},a.XgRzi=()=>{U.set("curIN2n","XgRzi"),q.say("A stern woman, clipboard in hand, oversees the workers bustling about the docks.  She barks orders with every other breath, gesturing curtly with bony fingers and an icy glare.  A bright green tabard marks her as a Realm adjutant.  Your approach hardly gives her pause.",a.BgtJr)},a.BgtJr=()=>{U.set("curIN2n","BgtJr"),q.say('"What is it?  What do you need?"',a.qlRtQ)},a.qlRtQ=()=>{U.set("curIN2n","qlRtQ"),q.choose("","qlRtQ",[{t:"Who are you?",cb:a.DERfp,c:()=>!0},{t:'What are "Larks"?',cb:a.Y5uuR,c:()=>U.get("nodes.DERfp")},{t:"Nevermind.",cb:a.w1b5S,c:()=>!0}])},a.DERfp=()=>{U.set("curIN2n","DERfp"),q.say('She spits at the ground.  "Faw!  Larks!  As clueless as ever I see."',a.Ip8B3)},a.Ip8B3=()=>{U.set("curIN2n","Ip8B3"),q.say("She points at her tabard as if that was self-explanitory.  \"I'm Claire.  Dock Master here in Alinea.  That means try to behave when I'm around or I'll have to send you into seclusion.  Had a few troublemakers just yesterday, thought they could sneak a few shipments of shelk into warehouse 3.\"  She shakes her head in disappointment.  \"I'd feel bad for them if I hadn't seen the like a hundred times over.\"",a.qlRtQ)},a.Y5uuR=()=>{U.set("curIN2n","Y5uuR"),q.say("\"It means you're new here.  Get used to that label.  You're the Larkiest Larks I've ever seen.\"",a.qlRtQ)},a.w1b5S=()=>{U.set("lasIN2f",U.get("curIN2f"));let e=t.NONE;e?e():q.exit()},void 0===e?a.G2sLG():e&&a[e](),U.state),t["Alinea_CH_DisgruntledPatron.json"]=e=>(U.set("curIN2f","Alinea_CH_DisgruntledPatron.json"),a.h96aB=()=>{U.set("curIN2n","h96aB"),U.once()?a.NtlSc():a.wA9ql()},a.NtlSc=()=>{U.set("curIN2n","NtlSc"),q.say("A man hunches over his goblet at one of the tables in this tavern.  When you approach he grunts noncommittally, but isn't outright hostile at the thought of speaking with you. ",a.EsyDb)},a.EsyDb=()=>{U.set("curIN2n","EsyDb"),q.choose("","EsyDb",[{t:"Something got you down?",cb:a.lgA0Q,c:()=>!0},{t:"What's wrong with that noble over there?",cb:a.T0fWE,c:()=>U.get("nodes.odtqY")},{t:"You mentioned the Guildimarche estate?",cb:a.f7rnl,c:()=>U.get("nodes.bxosg")},{t:"If he's that bad, maybe someone should knock that noble down a peg...",cb:a.PslAb,c:()=>U.get("nodes.Enl6R")},{t:"Nevermind.",cb:a.URfA6,c:()=>!0}])},a.lgA0Q=()=>{U.set("curIN2n","lgA0Q"),q.say("He lifts his head to look at you, and you notice that he is not the slightest bit inebriated.  He shoots an irritated glance at the noble sitting at a nearby table, then shrugs.",a.M9kBm)},a.M9kBm=()=>{U.set("curIN2n","M9kBm"),q.say('"Nah, not really.  Just trying to relax.  I move boxes all day.  It\'s tough work."',a.odtqY)},a.odtqY=()=>{U.set("curIN2n","odtqY"),q.say('"Although... relaxing\'s also tough with his lot around."  He gestures towards the noble.',a.EsyDb)},a.T0fWE=()=>{U.set("curIN2n","T0fWE"),q.say("\"Ah, he's just an ass.  Talk with him for five minutes and you'll see that, plain as day.\"",a.bxosg)},a.bxosg=()=>{U.set("curIN2n","bxosg"),q.say('"But honestly it\'s no surprise.  Everyone who works with the Guildimarche estate is like that one way or another."',a.Enl6R)},a.Enl6R=()=>{U.set("curIN2n","Enl6R"),q.say('"Just kinda ruins the mood of the place.  Wish he\'d go away."',a.EsyDb)},a.f7rnl=()=>{U.set("curIN2n","f7rnl"),q.say('"Larks..." he swirls his mug and takes a ship.',a.nZtqw)},a.nZtqw=()=>{U.set("curIN2n","nZtqw"),q.say("\"Guildemarche's a really influential family out here on Sadelica.  They own a lot of land, run a lot of operations.  Me?  I stay out of the way of them.  Everything they do is for their own benefit.  They'd leave someone like me to rot if given the chance.\"",a.EsyDb)},a.PslAb=()=>{U.set("curIN2n","PslAb"),q.say('"Heh, I\'m not about to rock the boat with the Guildimarche estate, but yeah maybe someone should."',a.lolrB)},a.lolrB=()=>{U.set("curIN2n","lolrB"),q.say("\"You know, by the docks there's a nice pit of rocks the perfect size for tossing at something.  I chase kids from the place sometimes when they get a mind to make that 'something' each other.\"",a.ZwciS)},a.ZwciS=()=>{U.set("curIN2n","ZwciS"),q.say('"Maybe one of those nice throwing rocks makes its way in here."',a.JuKBL)},a.JuKBL=()=>{U.set("curIN2n","JuKBL"),q.say('"And maybe someone realizes that game the kids play is actually a bit fun."',a.pUpZU)},a.pUpZU=()=>{U.set("curIN2n","pUpZU"),q.say("He sips his mug.",a.EsyDb)},a.URfA6=()=>{U.set("lasIN2f",U.get("curIN2f"));let e=t.NONE;e?e():q.exit()},a.wA9ql=()=>{U.set("curIN2n","wA9ql"),q.say('"Eh?"',a.EsyDb)},void 0===e?a.h96aB():e&&a[e](),U.state),t["Alinea_CH_Chem.json"]=e=>(U.set("curIN2f","Alinea_CH_Chem.json"),a.RLgZd=()=>{U.set("lasIN2f",U.get("curIN2f"));let e=t.NONE;e?e():q.exit()},void 0===e?a.RLgZd():e&&a[e](),U.state),t["Alinea_CH_BartoloCaldeburn.json"]=e=>(U.set("curIN2f","Alinea_CH_BartoloCaldeburn.json"),a.enWMm=()=>{U.set("curIN2n","enWMm"),U.once()?a.mqogS():a.SwzEw()},a.mqogS=()=>{U.set("curIN2n","mqogS"),q.say("A nobleman sits here, his clothes gaudy and pretentious, a deep blue lace lining every possible edge of his silk coat.  He clasps a large glass of plum wine and idly taps a finger on the rough wood of the table.  He ignores the other patrons in the room as his gaze passes imperiously by them to rest upon you.",a.dY7sz)},a.dY7sz=()=>{U.set("curIN2n","dY7sz"),q.say('"And what have we here?  Another rabble come to further dissuade me from this pit of a town?"',a.ku2iV)},a.ku2iV=()=>{U.set("curIN2n","ku2iV"),q.choose("","ku2iV",[{t:"Who are you?",cb:a.ASqD8,c:()=>!0},{t:"Don't like Alinea much?",cb:a.zkasm,c:()=>!0},{t:"You work for Lord Guildimarche?  Who is that?",cb:a.GM0EE,c:()=>U.get("nodes.ASqD8")},{t:"What is someone as 'esteemed' as you doing here?",cb:a.KLPVt,c:()=>U.get("nodes.ASqD8")},{t:"Idle threats?  Are you always this distasteful?",cb:a.DRtxf,c:()=>U.get("nodes.OfySb")},{t:"There are bandits to the north?",cb:a.wEid3,c:()=>U.get("nodes.KLPVt")},{t:"We might be able to take care of those bandits for you.",cb:a.st0xh,c:()=>U.get("nodes.wEid3")},{t:"Nevermind.",cb:a.udfI0,c:()=>!0}])},a.ASqD8=()=>{U.set("curIN2n","ASqD8"),q.say('"Lord Bartolo Caldeburn, originally of the Esthsmund Estates.  You\'ve heard of those?"',a.zfyBY)},a.zfyBY=()=>{U.set("curIN2n","zfyBY"),q.say("(You haven't.)",a.tE4LF)},a.tE4LF=()=>{U.set("curIN2n","tE4LF"),q.say('He grows irritated.  "Yes well... They are renowned on the Mainland for their luxury.  I suppose simpletons such as yourselves would not understand.  Suffice to say that I am important.  Very important.  You should certainly not underestimate that fact.  These days I give my assistance to Lord Guildimarche and his grand estate."',a.ku2iV)},a.zkasm=()=>{U.set("curIN2n","zkasm"),q.say('"Certainly not!  The people here no nothing of luxury.  They they think only in singles." He taps his glass. "A mere single selection of wine, a single bed, a single tavern...  How can a man visit this town with anything but disappointment?"',a.gIcZc)},a.gIcZc=()=>{U.set("curIN2n","gIcZc"),q.say('"Only thing it has plenty of is Larks."  He makes a shooing gesture at you.',a.ku2iV)},a.GM0EE=()=>{U.set("curIN2n","GM0EE"),q.say("He is aghast.  \"I do not 'work for' Lord Guildimarche, as you so uncouthly put it.  We are of the noble persuasion, we do favors for each other.  We lend aid!\"  ",a.ViWA8)},a.ViWA8=()=>{U.set("curIN2n","ViWA8"),q.say('"It just so happens that the Guildimarche estate has quite the pull on Sadelica.  Save for Alinea and perhaps the Magi Tower, go most anywhere on this island and you\'ll find some establishment associated with that name.  This is not a coincidence."',a.FBd0A)},a.FBd0A=()=>{U.set("curIN2n","FBd0A"),q.say('"Perhaps *you* would not know of such things, but support for a strong, well-established house tends to bear fruit."',a.ku2iV)},a.KLPVt=()=>{U.set("curIN2n","KLPVt"),q.say('"I am waiting for the Bandits currently occupying the northern bridge to be dealt with.  Then I can safety return to a place of relative sanity."',a.OfySb)},a.OfySb=()=>{U.set("curIN2n","OfySb"),q.say('"And might I advise you to watch your tone, or you might find your tongue in a ditch somewhere."  He takes a small sip from his drink, and you notice a wickedly curved blade on a hilt at his hip.',a.ku2iV)},a.DRtxf=()=>{U.set("curIN2n","DRtxf"),q.say('"Like most reasonable people, I do not suffer fools."',a.ku2iV)},a.wEid3=()=>{U.set("curIN2n","wEid3"),q.say('"Yes there are, and they have been quite the nuisance.  I\'m simply waiting for them to be dealt with.  It is only a matter of time."',a.ku2iV)},a.st0xh=()=>{U.set("curIN2n","st0xh"),q.say('"Do whatever you wish."',a.FFgQw)},a.FFgQw=()=>{U.set("curIN2n","FFgQw"),q.say("\"Just don't expect any kind of reward from me.  Like I said, it's just a matter of time before SOMEONE does it.\"",a.ku2iV)},a.udfI0=()=>{U.set("lasIN2f",U.get("curIN2f"));let e=t.NONE;e?e():q.exit()},a.SwzEw=()=>{U.set("curIN2n","SwzEw"),q.say('"Back again I see..."',a.ku2iV)},void 0===e?a.enWMm():e&&a[e](),U.state),t["Alinea_CH_SchovanAbivola.json"]=e=>(U.set("curIN2f","Alinea_CH_SchovanAbivola.json"),a.OhVgn=()=>{U.set("lasIN2f",U.get("curIN2f"));let e=t.NONE;e?e():q.exit()},void 0===e?a.OhVgn():e&&a[e](),U.state),t["Alinea_CH_SpyRigby.json"]=e=>(U.set("curIN2f","Alinea_CH_SpyRigby.json"),a.Hg9db=()=>{U.set("lasIN2f",U.get("curIN2f"));let e=t.NONE;e?e():q.exit()},void 0===e?a.Hg9db():e&&a[e](),U.state),t["Alinea_CH_BartenderRus.json"]=e=>(U.set("curIN2f","Alinea_CH_BartenderRus.json"),a.y9gCB=()=>{U.set("curIN2n","y9gCB"),U.once()?a.gUtER():a.mfEJp()},a.gUtER=()=>{U.set("curIN2n","gUtER"),q.say('The bartender of this tavern is a stout man with an amicable face.  "Good day to you!  Can I get you a drink?"',a.sZNhw)},a.sZNhw=()=>{U.set("curIN2n","sZNhw"),q.choose("","sZNhw",[{t:"A drink sounds nice.",cb:a.HyJzb,c:()=>!0},{t:'You mentioned someone named "Idoreo" who has sponsored this tavern?',cb:a.FpViJ,c:()=>U.get("nodes.WtgxM")&&!U.hasSpokenTo("Alinea_CH_Idoreo")},{t:"Idoreo sponsors this tavern?",cb:a.MMdxN,c:()=>U.get("nodes.WtgxM")&&U.hasSpokenTo("Alinea_CH_Idoreo")},{t:"Nevermind.",cb:a.MBMNa,c:()=>!0}])},a.HyJzb=()=>{U.set("curIN2n","HyJzb");let e=U.get("coins")>10;e&&(U.set("curIN2n","U4b6O"),q.say("",a.u06Bp)),e||(U.set("curIN2n","WfDHF"),q.say("",a.Orm12))},a.u06Bp=()=>{U.set("curIN2n","u06Bp"),q.say('"Plum wine or ale?"',a.n3c1E)},a.n3c1E=()=>{U.set("curIN2n","n3c1E"),q.choose("","n3c1E",[{t:"Plum wine sounds super 'del'. (What the hip kids are calling 'delicious' nowadays.)",cb:a.EoQtT,c:()=>!0},{t:"Ale would be great.",cb:a.h7hIn,c:()=>!0},{t:"Actually... maybe not.",cb:a.sZNhw,c:()=>!0}])},a.EoQtT=async()=>{U.set("curIN2n","EoQtT"),await U.modifyCoins(-6),a.ICNcg()},a.ICNcg=()=>{U.set("curIN2n","ICNcg"),q.say("After an odd glance with a raised eyebrow, he grabs a bottle from beneath the counter and skillfully pours you each a goblet of succulent plum wine.  Having just stepped off a trans-oceanic ship, it tastes heavenly.",a.WtgxM)},a.WtgxM=()=>{U.set("curIN2n","WtgxM"),q.say("The bartender grins.  \"That's a good stock isn't it?  You've got Idoreo to thank for that.  Loves the sweeter side of the drinks, so he offered to sponsor the tavern if I provided it.\"",a.sZNhw)},a.h7hIn=async()=>{U.set("curIN2n","h7hIn"),await U.modifyCoins(-6),a.xMq8B()},a.xMq8B=()=>{U.set("curIN2n","xMq8B"),q.say("He leaves the counter for a moment and comes back with an old barrel, heaving it onto the counter.  \"Sorry, most people don't ask for this, so I don't keep it front.\"  He pours a few mugs and pushes them across the bar at you.",a.AATnJ)},a.AATnJ=()=>{U.set("curIN2n","AATnJ"),q.say("The ale is... okay.  Even after your long journey across the ocean, it still tastes kind of bland.  It's plenty strong though.",a.sZNhw)},a.Orm12=()=>{U.set("curIN2n","Orm12"),q.say("You don't have enough money to waste on small luxuries like tavern drinks.",a.sZNhw)},a.FpViJ=()=>{U.set("curIN2n","FpViJ"),q.say("\"Idoreo is the merchant who owns of most of the warehouses in Alinea.  He charges for storage space and since Alinea is a port town, he's got himself a pretty valuable business.  He's well-known around here.\"",a.MMdxN)},a.MMdxN=()=>{U.set("curIN2n","MMdxN"),q.say("\"He sponsors this tavern.  Like I said, he's kinda got a sweet tooth.  As long as I stock up on good, plum wine, then he's happy, I'm happy, and we're all happy.\"",a.sZNhw)},a.MBMNa=()=>{U.set("lasIN2f",U.get("curIN2f"));let e=t.NONE;e?e():q.exit()},a.mfEJp=()=>{U.set("curIN2n","mfEJp"),q.say('"Here for a drink?"',a.sZNhw)},void 0===e?a.y9gCB():e&&a[e](),U.state),t["Alinea_CH_Scopey.json"]=e=>(U.set("curIN2f","Alinea_CH_Scopey.json"),a.bUbbt=()=>{U.set("lasIN2f",U.get("curIN2f"));let e=t.NONE;e?e():q.exit()},void 0===e?a.bUbbt():e&&a[e](),U.state),t["Alinea_CH_AldebethBlackrose.json"]=e=>(U.set("curIN2f","Alinea_CH_AldebethBlackrose.json"),a.xn4GD=()=>{U.set("curIN2n","xn4GD"),U.once()?a.Ck2ff():a.sBfVM()},a.Ck2ff=()=>{U.set("curIN2n","Ck2ff"),q.say("The leader of the mercenary company occupying these red tents is quite clearly this elegant and aristocratic woman.  Her exquisite silk dress is slashed with the the white and red that adorns the rose-like crest on all these tents, and a fashionable high-neck collar accentuates her ample bosom.  ",a.niNF7)},a.niNF7=()=>{U.set("curIN2n","niNF7"),q.choose("","niNF7",[{t:"Who are you?",cb:a.R3DD4,c:()=>!0},{t:"Blackrose LEGION!?  How many of you are there?",cb:a.fadc7,c:()=>U.get("nodes.BSReu")},{t:"What are you doing camped out here with a legion of fighters?",cb:a.iHiz6,c:()=>U.get("nodes.BSReu")},{t:"Any chance you're hiring fighters for your company?",cb:a.ZaWPY,c:()=>U.get("nodes.ya0uI")},{t:"If you have such a large army out here, why haven't you dealt with the bandits to the north?",cb:a.gIFEQ,c:()=>U.get("nodes.ceRC2")},{t:"Nevermind.",cb:a.QUeaf,c:()=>!0}])},a.R3DD4=()=>{U.set("curIN2n","R3DD4"),q.say("She raises a thinly-painted eyebrow.",a.dSLiT)},a.dSLiT=()=>{U.set("curIN2n","dSLiT"),q.say("\"It's surprising you don't know of me but... ah yes. You must be Larks.\"",a.BSReu)},a.BSReu=()=>{U.set("curIN2n","BSReu"),q.say('"I am Lady Aldebeth Blackrose.  I lead this contingent of the great Blackrose legion."',a.niNF7)},a.fadc7=()=>{U.set("curIN2n","fadc7"),q.say("Her lips curl into a slight smile.",a.ceRC2)},a.ceRC2=()=>{U.set("curIN2n","ceRC2"),q.say('"We are indeed, a great military force, renowned, and dare I say "feared" throughout Sadelica.  You should contain your awe better, it is unbecoming of any person to show such raw emotion."',a.niNF7)},a.iHiz6=()=>{U.set("curIN2n","iHiz6"),q.say('"We offer our services to those around Alinea."',a.ya0uI)},a.ya0uI=()=>{U.set("curIN2n","ya0uI"),q.say('"Caravan escorts, bodyguarding, perhaps a bit of menacing here and there.  A company like mine can be quite useful."',a.niNF7)},a.ZaWPY=()=>{U.set("curIN2n","ZaWPY"),q.say('"Perhaps... Lavolan has been bugging me about something of that sort recently.  Go speak with him."',a.niNF7)},a.gIFEQ=()=>{U.set("curIN2n","gIFEQ"),q.say('"Because we have not been paid to do it."',a.NJWhM)},a.NJWhM=()=>{U.set("curIN2n","NJWhM"),q.choose("","NJWhM",[{t:"Do you let greed control everything you choose to do?",cb:a.upE3L,c:()=>!0},{t:"They're clearly a problem for the region.  Call it a 'favor.'",cb:a.itEty,c:()=>!0},{t:"Makes sense.",cb:a.g3csZ,c:()=>!0}])},a.upE3L=()=>{U.set("curIN2n","upE3L"),q.say('"Greed is a complex motivation.  It can easily be predicated by self-preservation.  Recklessly using one\'s power whenever the slightest opportunity arises is the modus operandi of a thug, one that is likely to die much sooner than later."',a.eBpJ8)},a.eBpJ8=()=>{U.set("curIN2n","eBpJ8"),q.say('"Why should I risk my army when I have little more to gain than the prospect of a lesser-sized army?  The Blackrose estate would be shamed."',a.niNF7)},a.itEty=()=>{U.set("curIN2n","itEty"),q.say("\"For the region?  At worst they are a minor threat to Alinea's prosperity.  At best they are an inconvenience for the Guildemarche estate.  I have erected my camp here to keep an eye on them if this status quo changes, but they really haven't posed any major threat.\"",a.yoi5g)},a.yoi5g=()=>{U.set("curIN2n","yoi5g"),q.say('"Perhaps the situation will escalate, perhaps not.  I am poised to handle either eventuality."',a.q02WH)},a.q02WH=()=>{U.set("curIN2n","q02WH"),q.choose("","q02WH",[{t:'Are you "friends" with the Guildimarche Estate?',cb:a.WCV65,c:()=>!0},{t:"How cunning of you.",cb:a.Kx4r5,c:()=>!0}])},a.WCV65=()=>{U.set("curIN2n","WCV65"),q.say('"Certainly not!  Each trouble for him is a victory for the Blackrose Estate.  But, alas, we both are of the nobility, and usually reside on the same side of the conflict when all is said and done."',a.niNF7)},a.Kx4r5=()=>{U.set("curIN2n","Kx4r5"),q.say('"You\'ll come to find it takes a certain amount of that to survive on Sadelica."',a.niNF7)},a.g3csZ=()=>{U.set("curIN2n","g3csZ"),q.say("\"Indeed it does.  At worst these bandits are a minor threat to Alinea's prosperity.  At best they are an inconvenience for the Guildemarche estate.  I have erected my camp here to keep an eye on them if this status quo changes, but they really haven't posed any major threat.\"",a.yoi5g)},a.QUeaf=()=>{U.set("lasIN2f",U.get("curIN2f"));let e=t.NONE;e?e():q.exit()},a.sBfVM=()=>{U.set("curIN2n","sBfVM"),q.say('"Ah yes.  You.  What is it you want this time?"',a.niNF7)},void 0===e?a.xn4GD():e&&a[e](),U.state),t["Alinea_CH_GuardCaptainMullen.json"]=e=>(U.set("curIN2f","Alinea_CH_GuardCaptainMullen.json"),a.wgaDX=()=>{U.set("curIN2n","wgaDX"),a.xtxDG()},a.xtxDG=()=>{U.set("curIN2n","xtxDG"),U.once()?a.iBk1i():a.gWBQt()},a.iBk1i=()=>{U.set("curIN2n","iBk1i"),q.say("The man sitting behind the desk in this office appears to be a Realm Captain.  Though he has removed his helmet - the plumes of which indicate an officer's rank - the green sash across his chainmail is adorned with various medals, and there are far more of them than on any of the guards you've seen in Alinea thus far.  He glances up as you approach him, and his lips twitch into a tiny smile.  You distinctly hear the word \"Lark\" muttered under his breath.",a.Z0oAJ)},a.Z0oAJ=()=>{U.set("curIN2n","Z0oAJ"),q.choose("","Z0oAJ",[{t:"Who might you be?",cb:a.SmeNH,c:()=>!0},{t:"You seem... interested in me.  Why is that?",cb:a.ZXQRy,c:()=>!0},{t:"What exactly does the Realm do here?",cb:a.TlRap,c:()=>U.get("nodes.NfStn")},{t:"You mentioned that I'd be 'perfect' for something?",cb:a.KKukM,c:()=>U.get("nodes.NfStn")},{t:"Nevermind.",cb:a.F3tbm,c:()=>!0}])},a.SmeNH=()=>{U.set("curIN2n","SmeNH"),q.say("A small pause and grimace indicate he was ready for the question, but certainly not eager to answer it hastily.",a.gOm7y)},a.gOm7y=()=>{U.set("curIN2n","gOm7y"),q.say('"Guard Captain Mullen.  Overseer of the Realm enforcement here."',a.Z0oAJ)},a.ZXQRy=()=>{U.set("curIN2n","ZXQRy"),q.say('"Because your a Lark."',a.m4shd)},a.m4shd=()=>{U.set("curIN2n","m4shd"),q.say("He puts his hands up like this is the most self-explanatory thing in the world.",a.NfStn)},a.NfStn=()=>{U.set("curIN2n","NfStn"),q.say('"Whether or not you intend it, people like you come into town and upset the status quo.  Normally I hate that sort of thing, but right now you might be just the thing I need."',a.Z0oAJ)},a.TlRap=()=>{U.set("curIN2n","TlRap"),q.say('"We keep everyone\'s power in check."',a.D5RSu)},a.D5RSu=()=>{U.set("curIN2n","D5RSu"),q.say("He clears his throat like he's getting ready for a lengthy explanation...",a.FgpK0)},a.FgpK0=()=>{U.set("curIN2n","FgpK0"),q.choose("","FgpK0",[{t:"(Let him continue.)",cb:a.tk1HK,c:()=>!0},{t:"Yeah, yeah.  No need to explain.  That makes sense.",cb:a.Z0oAJ,c:()=>!0}])},a.tk1HK=()=>{U.set("curIN2n","tk1HK"),q.say('"The Realm owns the Mainland.  This is well-known, even to somebody like you.  But what you may not know is that the Realm does not own Sadelica.  The fact of the matter is that we don\'t have enough influence or force to hold it and the Mainland simultaneously.  So the Realm have declared it a neutral territory."',a.dAiOV)},a.dAiOV=()=>{U.set("curIN2n","dAiOV"),q.say('"This, of course, poses a problem.  If the Realm lets any other faction become too powerful on Sadelica, then it will be that much more difficult to come conquer it later - which of course will happen eventually.  But the fact remains that we can benefit greatly by preventing anybody from gaining too much influence."',a.lWqhH)},a.lWqhH=()=>{U.set("curIN2n","lWqhH"),q.say('"A select contingent of Realm military resides on Sadelica to keep maintain this directive.  I, my men - and of course Dockmaster Claire - are a part of this contingent garrisoned here in Alinea."',a.Z0oAJ)},a.KKukM=()=>{U.set("curIN2n","KKukM"),U.once()?a.r47RH():a.fKO2y()},a.r47RH=()=>{U.set("curIN2n","r47RH"),q.say('"As a matter of fact, yes."',a.yJXxC)},a.yJXxC=()=>{U.set("curIN2n","yJXxC"),q.say('"You may have heard this from someone else in town, but there is a stubborn group of bandits blocking the bridge that leads north, towards Boromak."',a.AlVli)},a.AlVli=()=>{U.set("curIN2n","AlVli"),q.say('"I\'ve also got a little... intel mission I need assistance with.  A Lark would be perfect."',a.FIdYK)},a.FIdYK=()=>{U.set("curIN2n","FIdYK"),q.choose("","FIdYK",[{t:"Tell me about the bandits.",cb:a.alz6T,c:()=>!0},{t:"The intel mission sounds a bit... spicy.",cb:a.QO8ly,c:()=>!0},{t:"Let's talk about something else.",cb:a.Z0oAJ,c:()=>!0}])},a.alz6T=()=>{U.set("curIN2n","alz6T"),q.say("\"It's quite simple. I need them taken care of, and I don't have the manpower to do it.  Obviously you're just one person, but I've got a plan that you'd be just the right person for.\"",a.MlDXt)},a.MlDXt=()=>{U.set("curIN2n","MlDXt"),q.choose("","MlDXt",[{t:"Aren't you people trying to be neutral?",cb:a.hWLiL,c:()=>U.get("nodes.TlRap")},{t:"Retreat?  Why would you have to do that?  Are you under attack or something?",cb:a.cxpVw,c:()=>U.get("nodes.hWLiL")},{t:"How can I help?",cb:a.aM3sp,c:()=>!0}])},a.hWLiL=()=>{U.set("curIN2n","hWLiL"),q.say("\"Yes, of course!  But we've got a complex situation here.  Those bandits blocking that bridge means we can't bring in supplies from up there.  And if we run out of anything, we run high risk of having to retreat.\"",a.MlDXt)},a.cxpVw=()=>{U.set("curIN2n","cxpVw"),q.say('"You don\'t need a battle to be under attack.  Sadelica is a cutthroat place.  You show any weakness and somebody will come try to crush you."',a.MgaCV)},a.MgaCV=()=>{U.set("curIN2n","MgaCV"),q.say("\"For example, that Blackrose camp on the east side of town.  Lady Blackrose says she's here to provide mercenary service, but you can bet she's considering a takeover if she thinks she can get away with it.\"",a.G2bu8)},a.G2bu8=()=>{U.set("curIN2n","G2bu8"),q.choose("","G2bu8",[{t:"Sounds like you guys have it rough out here.",cb:a.zTDaS,c:()=>!0},{t:"Isn't that... treason?",cb:a.RPCB5,c:()=>!0}])},a.zTDaS=()=>{U.set("curIN2n","zTDaS"),q.say('"Out here, only the strong can survive."',a.MlDXt)},a.RPCB5=()=>{U.set("curIN2n","RPCB5"),q.say("\"On the Mainland, yes, of course.  But that kind of thing isn't applied on Sadelica.  The Realm doesn't own this land.\"",a.zTDaS)},a.aM3sp=()=>{U.set("curIN2n","aM3sp"),q.say("\"The bandits have a camp to the north.  Your job would be to sneak in and take out their leader.  I've seen him myself, and I can grantee he's the reason for their obstinance.\"",a.Ca2EO)},a.Ca2EO=()=>{U.set("curIN2n","Ca2EO"),q.choose("","Ca2EO",[{t:"What makes you think I'm capable of doing that?",cb:a.ZOsRf,c:()=>!0},{t:"Sounds fun!",cb:a.FUaJT,c:()=>!0},{t:"Why would I do that?",cb:a.UCXaC,c:()=>!0}])},a.ZOsRf=()=>{U.set("curIN2n","ZOsRf"),q.say("\"Just a hunch.  You look like you know your way around a fight.  Of course you don't have to do it if you don't want to.  Consider it an opportunity to help the Realm.  A favor.  I'd certainly be in your debt.\"",a.J7toV)},a.J7toV=()=>{U.set("curIN2n","J7toV"),q.choose("","J7toV",[{t:"I'll consider it.",cb:a.FIdYK,c:()=>!0},{t:"No thanks.",cb:a.FIdYK,c:()=>!0}])},a.FUaJT=()=>{U.set("curIN2n","FUaJT"),q.say("He raises an eyebrow at you, but eventually just shrugs.",a.PtNUI)},a.PtNUI=()=>{U.set("curIN2n","PtNUI"),q.say("\"Your 'fun' is my gain.\"",a.J7toV)},a.UCXaC=()=>{U.set("curIN2n","UCXaC"),q.say('"Because the Realm can provide adequate compensation for such a task."',a.J7toV)},a.QO8ly=()=>{U.set("curIN2n","QO8ly"),q.say('"It should actually be quite simple."',a.GBVGl)},a.GBVGl=()=>{U.set("curIN2n","GBVGl"),q.say("\"You may or may not know, but there's a large encampment on the eastern side of Alinea.  It's a military force under the control of the esteemed Blackrose estate.\"",a.UbFi4)},a.UbFi4=()=>{U.set("curIN2n","UbFi4"),q.say('"The force they have here is... quite powerful.  Lady Blackrose says she\'s here to provide mercenary service for the Merchantry here, but I suspect she has other reasons.  I needed a way to keep an eye on them."',a.pMA8S)},a.pMA8S=()=>{U.set("curIN2n","pMA8S"),q.say("\"I've got a spy in their ranks.  Your task would be simply to make contact and report back to me.  It's easy for a Lark to go anywhere here, this should be, as I said, quite simple.\"",a.nFPBP)},a.nFPBP=()=>{U.set("curIN2n","nFPBP"),q.choose("","nFPBP",[{t:"Is there a payment involved for this?",cb:a.QRl7s,c:()=>!0},{t:"I'll consider it.",cb:a.FIdYK,c:()=>!0},{t:"No thanks.",cb:a.FIdYK,c:()=>!0}])},a.QRl7s=()=>{U.set("curIN2n","QRl7s"),q.say('"The Realm always provides payment for services rendered to it."',a.nFPBP)},a.fKO2y=()=>{U.set("curIN2n","fKO2y"),q.say('"Like I explained, I\'ve got problems with bandits, and an intel mission."',a.FIdYK)},a.F3tbm=()=>{U.set("lasIN2f",U.get("curIN2f"));let e=t.NONE;e?e():q.exit()},a.gWBQt=()=>{U.set("curIN2n","gWBQt"),q.say('"You need something?"',a.Z0oAJ)},void 0===e?a.wgaDX():e&&a[e](),U.state),t.exit=()=>{q.exit()},{files:t,scope:a}}(),l=()=>{Xt(!1);let e=Je("map1");Vt(e),L(e),hs()};window.addEventListener("load",async()=>{await Promise.all([ze([["packed","packed.png",16,16,2,2,["terrain2","terrain3","actors2","misc1"]],["terrain1","terrain1.png",16,16,1,1,["terrain1"]],["actors1","actors1.png",16,16,1,1,["actors1"]],["map1","map1.png",64,64,1,1,["map1"]],["portrait1","portrait1.png",32,32,1,1,["portrait1"]]]),Ka()]),G(),g(),l()});let c=(e,t,a)=>{if(0===a)return[[e,t]];{let a=[];for(let s=-1;s<=1;s++)for(let n=-1;n<=1;n++)a.push([e+n,t+s]);return a}},h=(e,t)=>Math.floor(Math.random()*(t-e)+e),u=e=>e[h(0,e.length)],d=(e,t,a,s,n)=>{if(t===e)return 0;let[o,r]=a,i=h(o,r);He(fe(t),-i);let[l,c]=we(t),u=mt(15,l,c,""+i),d=ua(n);return ft(d,u),Ee(e,!0),s&&Qa(s),i},y=[(e,t)=>{},(e,t)=>{let a=h(0,10)+"";_(e,a,t,{intentToAttack:!1})},(e,t)=>{let a=(e,t)=>{let[a,s]=we(e),[n,o]=we(t);return[n-a,o-s]};if(((e,t)=>{let[s,n]=a(e,t);return Math.abs(s)<6&&Math.abs(n)<6})(e,ut(t.player))){let s=((e,t)=>{let[s,n]=a(e,t);return 0===n?s>0?[S]:[x]:0===s?n>0?[A]:[k]:s>0&&n>0?[R,A,S]:s>0&&n<0?[B,k,S]:s<0&&n>0?[T,A,x]:[E,k,x]})(e,ut(t.player));for(let a in s)if(_(e,s[a],t))break}}],m=!1,p=!1,f=e=>{let t=Ut();m?p||(p=!0,setTimeout(()=>{m=!1,p&&(p=!1,f(e))},16)):(m=!0,$a(),is(e,t))},g=()=>{let e={40:A,34:R,35:T,37:x,12:C,39:S,36:E,38:k,33:B,98:A,99:R,97:T,100:x,101:C,102:S,103:E,104:k,105:B,81:E,87:k,69:B,65:x,83:C,68:S,90:T,88:A,67:R};window.addEventListener("keydown",t=>{let a=Jt();if(Qt())return;if(ha().visible)return;let{which:s}=t,n=e[s]||s,o=ut(a.player),r=ua(a);switch(!0){case(c=+n)>=1&&c<=9:t.preventDefault(),l=n,b(),M(a.player,l,a);break;case 27===n:b(),hs(),f(a);break;case 192===n:let e=Nt(r,o),[s,h,u]=e[0]||[];s&&v(s,o,h,u,r);break;case 32===n:{let e=(wt(r,o)||[])[0];if(e){let t=Le(e);"string"==typeof t&&""!==t?((e,t)=>{let a=ra();a.splice(0,a.length),ca(t||null),Qa("talk"),la(!0),Xt(!0),qt(!0),Yt(!0),hs(),(e=>{let t=i.files[e+".json"];t?t():console.error(`Cannot play in2 dialog, no key exists: '${e}'`)})(e)})(t,e):"function"==typeof t&&t()}}default:if(!t.shiftKey&&n>48&&n<=57){let e=n-49,t=ge(o)[e];if(t){let a=at(t);ot(t)?(sa(e),N(a,o)):lt(t)&&w(e,o)}}if(t.shiftKey&&n>48&&n<=57||192===t.which){let e=Nt(r,o),t=n-49,[a,s,i]=e[t]||[];a&&v(a,o,s,i,r)}}var l,c});let t=qe();t.onmousemove=e=>{let t=Jt(),a=Ut();if(aa()){let{offsetX:s,offsetY:n}=e,o=oa(),r=ut(t.player),[i,l]=we(r),h=Kt()*a,u=i*h+h/2,d=l*h+h/2,y=Math.floor(s/h),m=Math.floor(n/h);ls(u,d,s,n),At(c(y,m,o),ua(t)),f(t)}else cs()},t.onmousedown=e=>{let t=ea();if(t){let a=Jt(),{offsetX:s,offsetY:n}=e,o=2*Kt();t(Math.floor(s/o),Math.floor(n/o)),f(a)}}},b=()=>{cs(),na(),xt(ua(Jt()));let e=ea();e&&e(-1,-1)},I=(e,t)=>{let[a,s]=we(e)},N=async(e,t)=>{Qa("use"),hs(),await rt(e)(t)&&(Ne(t,e),sa(-1)),hs()},w=async(e,t)=>{Qa("eqp"),Ae(t,e),hs(),L(Jt())},v=(e,t,a,s,n)=>{let o=at(e),r=et(o);It(n,r,a,s),it(e)&&(Ie(t,e),Qa("acquire")),hs(),L(Jt())},k="8",A="2",x="4",S="6",C="5",E="7",B="9",T="1",R="3",M=(e,t,a)=>{let s=ut(e);_(s,t,a,{intentToAttack:!1,isPlayer:!0}),(e=>{let t=ut(e),[a,s]=we(t),{wx:n,wy:o}=e,r=n,i=o,l=Zt();return a<0&&(n--,a=l-1),s<0&&(o--,s=l-1),a>=l&&(n++,a=0),s>=l&&(o++,s=0),yt(e,n,o),ve(t,a,s),r!==n||i!==o})(e)?L(a):D()},H={intentToAttack:!1,isPlayer:!1},_=(e,t,a,s)=>{let{isPlayer:n,intentToAttack:o}=Object.assign(Object.assign({},s||{}),H),r=ua(a),[i,l,c,u,d]=((e,t,a)=>{let[s,n]=we(e),o=s,r=n;switch(t){case k:n--;break;case A:n++;break;case x:s--;break;case S:s++;break;case E:s--,n--;break;case B:s++,n--;break;case T:s--,n++;break;case R:s++,n++}let i=s,l=n,c=[o,r,i,l,!1],h=ua(a);if(h){let t=gt(h,s,n);if(t&&Bt(t)&&ut(a.player)===e)return Tt(t),Qa("doorOpen"),c;if(t&&!Ct(t))return c;if(pt(h,s,n))return c}return[s,n,i,l,!0]})(e,t,a);((e,t,a)=>{let[s,n]=we(e),o=s-t;xe(e,o>0?he:0===o?n-a>0?ue:he:ue)})(e,c,u),n||(e=>{let[t,a]=we(e),s=Zt();t<0&&(t=0),a<0&&(a=0),t>=s&&(t=s-1),a>=s&&(a=s-1),ve(e,t,a)})(e),ve(e,i,l);let y=pt(r,c,u),m=Me(e);return o&&y&&m!==Me(y)?(((e,t,a)=>{if(t===e)return 0;let[s,n]=De(e),o=h(s,n+1);He(fe(t),-o);let[r,i]=we(t),l=mt(0,r,i,""+o),c=ua(a);ft(c,l),Ee(e,!0),Qa("strike")})(e,y,a),!0):d},D=()=>{Xt(!0);let e=Jt(),t=ua(e);for(let e=0;e<t.actors.length;e++)Se(t.actors[e],!0);O()},L=e=>{let t=ua(e),a=ut(e.player),[s,n]=we(a);F(s,n,t),$a(),is(e,2)},O=()=>{let e=Jt(),t=ua(e);if(t.p.length){for(let e=0;e<t.p.length;e++){let a=t.p[e],[,s,n]=a;+new Date-s>=n&&(t.p.splice(e,1),e--)}return setTimeout(O,32),void L(e)}let a=ut(e.player);if(Be(a),Te(a))return Qa("lose"),void setTimeout(()=>{l()},2e3);for(let a=0;a<t.actors.length;a++){let s=t.actors[a];if(Te(s))t.actors.splice(a,1),a--,I(s),Qa("dead"),s[13]&&s[13]();else if(Ce(s)){Se(s,!1);let t=Re(s);(0,y[t])(s,e)}else Be(s)}L(e),hs(),setTimeout(()=>{Xt(!1)},32)},W=()=>{let e=ha();e.visible=!1,e.cb=void 0,hs()},P=e=>{let t=[];for(var a=0;a<e[0];++a)t.push(1===e.length?0:P(e.slice(1)));return t},F=(e,t,a)=>{let s=Zt(),n=P([s,s]),o=(e,t,s,o)=>{let r=1,i=Math.abs(s-e),l=e<s?1:-1,c=Math.abs(o-t),h=t<o?1:-1,u=(i>c?i:-c)/2,d=0;for(;d++,!(d>10);){let d=e,y=t;if(void 0===n[y]||void 0===n[y][d]){let a=u;a>-i&&(u-=c,e+=l),a<c&&(u+=i,t+=h);continue}if(0!==n[y][d]&&1!==r||(n[y][d]=r),Et(gt(a,d,y))&&(r=0),e===s&&t===o)break;let m=u;m>-i&&(u-=c,e+=l),m<c&&(u+=i,t+=h)}},r=a=>{for(let s=-a;s<=a;s++)o(e,t,e+s,t+a),o(e,t,e+s,t-a),o(e,t,e+a,t+s),o(e,t,e-a,t+s)};r(8),r(7),r(6),r(5),n[t][e]=1,((e,t)=>{for(let a=0;a<t.length;a++)for(let s=0;s<t[0].length;s++)e[a][s]=e[a][s]||t[a][s]})(a.explMap,n),a.visMap=n},j={},G=()=>{let e=(e,t)=>{j[e]?j[e].push(t):j[e]=[t]};e("1,3,24,28",Ra),e("1,3,11,23",Ma),e("1,3,34,19",va),e("1,3,34,20",va),e("1,3,35,19",va),e("1,3,35,20",va),e("1,3,49,19",va),e("1,3,48,19",va),e("1,3,49,20",va),e("1,3,48,20",va),e("1,3,49,21",va),e("1,3,48,21",va),e("1,3,49,22",va),e("1,3,48,22",va),e("1,3,49,23",va),e("1,3,48,23",va),e("1,3,49,24",va),e("1,3,48,24",va),e("1,3,44,35",va),e("1,3,46,34",va),e("1,3,45,32",va),e("1,3,49,34",va),e("1,3,48,30",va),e("1,3,49,31",va),e("1,3,47,32",va),e("1,3,44,31",ka),e("1,3,34,23",ka),e("1,3,34,24",ka),e("1,3,35,24",ka),e("1,3,35,23",ka),e("1,3,16,29",Wa),e("1,3,26,46",Ha),e("1,3,15,26",_a),e("1,3,20,24",Pa),e("1,3,24,31",Fa),e("1,3,45,36",ja),e("1,3,45,29",ja),e("1,3,45,25",Ga),e("1,3,45,18",Ga),e("1,3,38,18",za),e("1,3,38,25",za),e("2,3,9,18",Ya),e("2,3,9,25",Ya),e("2,3,23,18",qa),e("2,3,23,25",qa),e("2,3,23,29",Ua),e("2,3,23,36",Ua),e("2,3,9,29",Va),e("2,3,9,36",Va),e("2,3,35,44",Ja),e("1,3,14,7",La),e("1,3,11,7",La),e("1,3,7,44",La),e("1,3,53,8",La),e("1,3,53,17",La),e("1,3,57,27",Da),e("1,3,43,3",Da),e("1,3,7,3",Da),e("1,3,36,29",Da),e("1,3,8,36",Oa)},z="Press any key or click here to continue.",Y=!!window.IN2;var q=window.core={async init(){await e()},async say(e,t){if("object"==typeof e){if(1!==e.length)return void q.say(e[0],()=>{q.say(e.slice(1),t)});V(e)}else{if(e.length<=1)return void(t&&t());V(e),V(z,"#9D9D9D",t)}if(!Y)return new Promise(e=>{J.setK(()=>{t&&t(),e()})})},async choose(e,t,a){return new Promise(t=>{V(e||"Select an option.","#9D9D9D"),V("-----","#9D9D9D");let s=a.filter(e=>!!e.c()).map((e,a)=>({text:a+1+".) "+e.t,cb:async()=>{this.onChoose(),await e.cb(),t()}}));s.forEach(({text:e,cb:t})=>{V(e,"#F7E26B",t)}),V("-----","#9D9D9D"),J.setK(async e=>{let a=s[e-1];a&&(J.setK(()=>{}),V(a.text,"#EB8931"),await a.cb(),t())})})},onChoose(){ra().forEach(e=>{e.cb=void 0})},async defer(e,t){t=t||[this.get("curIN2n"),this.get("curIN2f")],await e.apply(null,t)},exit(){J.setK(()=>{}),Qa("talkEnd"),la(!1),qt(!1),Yt(!1),hs(),setTimeout(()=>{Xt(!1)},100)}},U=window.player={state:{coins:100},init(){this.state={}},get(e){let t=(e,a)=>{let s=e.shift();if(!e.length)return void 0===a[s]?void 0:a[s];let n=a[s];return void 0!==n?t(e,n):void 0};return t(e.split("."),this.state)},set(e,t){"curIN2n"===e&&this.set("nodes."+t),"curIN2f"===e&&this.set("files."+t.replace(".json","")),t=void 0===t||t;let a=(e,s)=>{let n=e.shift();void 0!==n&&(e.length?(s[n]||(s[n]={}),a(e,s[n])):s[n]=t)};a(e.split("."),this.state)},once(){let e="once."+this.get("curIN2n");return!this.get(e)&&(this.set(e),!0)},setIfUnset(e,t){void 0===this.get(e)&&this.set(e,t)},async modifyCoins(e){let t=U.get("coins")||0;t+=e,t<0&&(t=0),U.set("coins",t),await q.say(e>0?`Gained ${e} coins.`:`Lost ${-e} coins.`)},hasSpokenTo:e=>U.get("files."+e)},V=(e,t,a)=>{let s=ra(),n=s[s.length-1];n&&n.text===z&&s.splice(s.length-1,1),ra().push({text:e,color:t,cb:a}),hs(),document.getElementById("dialog").scrollTop=999999},J=new function(){let e=()=>{};this.setK=t=>e=t,window.addEventListener("keydown",t=>{this.disabled||e(String.fromCharCode(t.which))})},Z={},K=[],Q=e=>null==e?e:e.key,X=function(e){this.tag[e.type](e)},$=(e,t,a,s,n)=>{"key"===t||("o"===t[0]&&"n"===t[1]?((e.tag||(e.tag={}))[t=t.slice(2)]=s)?a||e.addEventListener(t,X):e.removeEventListener(t,X):!n&&"list"!==t&&"form"!==t&&t in e?e[t]=null==s?"":s:null==s||!1===s?e.removeAttribute(t):e.setAttribute(t,s))},ee=(e,t)=>{var a=e.props,s=3===e.tag?document.createTextNode(e.type):(t=t||"svg"===e.type)?document.createElementNS("http://www.w3.org/2000/svg",e.type,{is:a.is}):document.createElement(e.type,{is:a.is});for(var n in a)$(s,n,null,a[n],t);return e.children.map(e=>s.appendChild(ee(e=ae(e),t))),e.dom=s},te=(e,t,a,s,n)=>{if(a===s);else if(null!=a&&3===a.tag&&3===s.tag)a.type!==s.type&&(t.nodeValue=s.type);else if(null==a||a.type!==s.type)t=e.insertBefore(ee(s=ae(s),n),t),null!=a&&e.removeChild(a.dom);else{var o,r,i,l,c=a.props,h=s.props,u=a.children,d=s.children,y=0,m=0,p=u.length-1,f=d.length-1;for(var g in n=n||"svg"===s.type,Object.assign(Object.assign({},c),h))("value"===g||"selected"===g||"checked"===g?t[g]:c[g])!==h[g]&&$(t,g,c[g],h[g],n);for(;m<=f&&y<=p&&null!=(i=Q(u[y]))&&i===Q(d[m]);)te(t,u[y].dom,u[y++],d[m]=ae(d[m++]),n);for(;m<=f&&y<=p&&null!=(i=Q(u[p]))&&i===Q(d[f]);)te(t,u[p].dom,u[p--],d[f]=ae(d[f--]),n);if(y>p)for(;m<=f;)t.insertBefore(ee(d[m]=ae(d[m++]),n),(r=u[y])&&r.dom);else if(m>f)for(;y<=p;)t.removeChild(u[y++].dom);else{var b={},I={};for(g=y;g<=p;g++)null!=(i=u[g].key)&&(b[i]=u[g]);for(;m<=f;)i=Q(r=u[y]),l=Q(d[m]=ae(d[m])),I[i]||null!=l&&l===Q(u[y+1])?(null==i&&t.removeChild(r.dom),y++):null==l||1===a.tag?(null==i&&(te(t,r&&r.dom,r,d[m],n),m++),y++):(i===l?(te(t,r.dom,r,d[m],n),I[l]=!0,y++):null!=(o=b[l])?(te(t,t.insertBefore(o.dom,r&&r.dom),o,d[m],n),I[l]=!0):te(t,r&&r.dom,null,d[m],n),m++);for(;y<=p;)null==Q(r=u[y++])&&t.removeChild(r.dom);for(var g in b)null==I[g]&&t.removeChild(b[g].dom)}}return s.dom=t},ae=e=>!0!==e&&!1!==e&&e?e:oe(""),se=e=>3===e.nodeType?oe(e.nodeValue,e):ne(e.nodeName.toLowerCase(),Z,K.map.call(e.childNodes,se),e,null,1),ne=(e,t,a,s,n,o)=>({type:e,props:t,children:a,dom:s,key:n,tag:o}),oe=(e,t)=>ne(e,Z,K,t,null,3);let re=oe,ie=(e,t,a)=>ne(e,t,Array.isArray(a)?a:null==a?K:[a],null,t.key);var le=(e,t)=>((e=te(e.parentNode,e,e.v||se(e),t)).v=t,e),ce=.3;zzfxX=new(window.AudioContext||webkitAudioContext);let he=0,ue=1,de=e=>[e,e],ye=(e,t,a)=>{let[s,n,o,r,i,l,c,h,u,d,y]=a;return[o,n,s,e,t,r,[],u,i,!1,!1,h,0,()=>{},l,c,d,y]},me=e=>e[0],pe=e=>{let t=e[2],a={0:{[Ze]:da.PlayerUnequipped,[Ke]:da.Player,[Qe]:da.PlayerKnife,[Xe]:da.PlayerSpear,[$e]:da.PlayerBow}}[t];if(a){let s=ke(e);t=s?a[ht(s)]:a[Ze]}return e[1]+"_"+(t+(e[10]?1:0))+(e[7]===he?"_f":"")},fe=e=>e[5],ge=e=>e[6],be=(e,t,a)=>{let s=ge(e),n=at(t),o=et(n);for(let n=0;n<s.length;n++){let r=s[n],i=at(r);if(o===et(i)){if(a){let e=st(t),a=nt(r,e);s[n]=a}else{let t=nt(r,-1);if(t)s[n]=t;else{let t=ke(e),a=e[12];if(t){let s=at(t);et(s)===o?Ae(e,-1):a>n&&Ae(e,a-1)}s.splice(n,1)}}return}}a&&s.push(t)},Ie=(e,t)=>{be(e,t,!0)},Ne=(e,t)=>{be(e,t,!1)},we=e=>e.slice(3,5),ve=(e,t,a)=>{e[3]=t,e[4]=a},ke=e=>ge(e)[e[12]]||null,Ae=(e,t)=>{e[12]=t},xe=(e,t)=>{e[7]=t},Se=(e,t)=>{e[9]=t},Ce=e=>e[9],Ee=(e,t)=>{e[10]=t},Be=e=>{Ee(e,!1)},Te=e=>_e(fe(e))<=0,Re=e=>e[8],Me=e=>0===Re(e)?0:1,He=(e,t)=>{e[0]+=t,e[0]<0?e[0]=0:e[0]>e[1]&&(e[0]=e[1])},_e=e=>e[0],De=e=>{let t=ke(e),[a,s]=[1,3];if(t){let[n,o]=ct(at(t),e);a+=n,s+=o}return[a,s]},Le=e=>e[14]||"",Oe=e=>e[17],We=null,Pe=null,Fe=null,je=e=>{let[t,a,s]=Ye(e.width,e.height);return a.translate(s,0),a.scale(-1,1),a.drawImage(e,0,0),t},Ge=e=>{let[,,,t,a]=e,[s,n]=Ye(t,a);return ts(e,0,0,1,n),s},ze=async e=>{let t={},a={};await Promise.all(e.map(([e,s,n,o,r,i,l])=>new Promise(c=>{let h=new Image;h.onload=()=>{t[e]=h,((e,t,a,s,n,o,r)=>{let i=(t,a,s,n,o,r)=>e[t]=[a,s,n,o,r],l=t.width/s/o,c=t.height/n/r;for(let e=0;e<r;e++)for(let r=0;r<o;r++){let h=a[e*o+r],u=0;for(let a=0;a<c;a++)for(let o=0;o<l;o++){let d=`${h}_${u}`,y=i(`${h}_${u}`,t,r*s*l+o*s,e*n*c+a*n,s,n);i(d+"_f",je(Ge(y)),0,0,s,n),u++}}})(a,h,l,n,o,r,i),c()},h.src=s}))),Pe=t,Fe=a},Ye=(e,t)=>{let a=document.createElement("canvas");a.width=e,a.height=t;let s=a.getContext("2d");return s.imageSmoothingEnabled=!1,[a,s,e,t]},qe=()=>{if(We)return We;{let[e,t]=Ye(544,544);return e.id="canv",t.lineWidth=2,window.canvasDiv.appendChild(e),We=e,e}},Ue=()=>qe().getContext("2d"),Ve={};for(let e=0;e<256;e++)Ve[`${e}${e}${e}`]=e;let Je=e=>{let t=["player","actors1",0,0,0,de(100),[Sa,Ca,Ba,Ea,[Ta,3]],0,0,!0,!1,0,0,0,"","","",0],a={wx:0,wy:0,actor:t,gold:0},[s,n,o,r]=(i=Zt(),[Math.floor(87/i),Math.floor(226/i),87%i,226%i-1]);var i;yt(a,s,n),ve(t,o,r);let l={rooms:[],p:[],player:a,end:[]},c=Zt();for(let e=0;e<16;e++){let t={lvl:0,id:e,tiles:[],p:[],visMap:P([c,c]),explMap:P([c,c]),items:[],actors:[],mod:""};l.rooms.push(t)}l.rooms[0].lvl=1;for(let t=0;t<16;t++){let{tiles:a,mod:s,actors:n}=l.rooms[t],[,o]=Ye(64,64),r=t%4,i=Math.floor(t/4);ts(e+"_"+t+s,0,0,1,o);let{data:h}=o.getImageData(0,0,64,64),d=0;for(let e=0;e<h.length;e+=4){let t=Ve[`${h[e+0]}${h[e+1]}${h[e+2]}`]||0,s=d%64,o=Math.floor(d/64),l=o*c+s;t===Ia.Grass?t=u(fa):t===Ia.CaveFloor&&(t=u(ga)),a[l]=["terrain1_"+t,t,s,o,!1];let y=j[[r,i,s,o].join(",")];y&&y.forEach(e=>{let t=ye(s,o,e);n.push(t)}),d++}}return l},Ze=0,Ke=1,Qe=2,Xe=3,$e=4,et=e=>e[1],tt=e=>"misc1_"+e[0],at=e=>2===e.length?e[0]:e,st=e=>2===e.length?e[1]:1,nt=(e,t)=>{if(2===e.length){let a=e[1]+t;return a<0&&(a=0),e[1]=a,a?e:null}return t>0?[e,1+t]:null},ot=e=>!!rt(e),rt=e=>at(e)[2].onUse,it=e=>{let t=at(e)[2].onAcq;return!t||t()},lt=e=>!!at(e)[2].getDmg,ct=(e,t)=>{let a=e[2];return a.getDmg?a.getDmg(t):[0,0]},ht=e=>at(e)[4]||Ze,ut=e=>e.actor,dt=e=>[e.wx,e.wy],yt=(e,t,a)=>{e.wx=t,e.wy=a},mt=(e,t,a,s)=>["misc_"+e,+new Date,500,t,a,s],pt=(e,t,a)=>{for(let s=0;s<e.actors.length;s++){let n=e.actors[s],[o,r]=we(n);if(o===t&&r===a)return n}let s=Jt();if(s){let e=ut(s.player),[n,o]=we(e);if(n===t&&o===a)return e}return null},ft=(e,t)=>{e.p.push(t)},gt=(e,t,a)=>{let s=Zt();return t<0||t>=s||a<0||a>=s?null:e.tiles[a*Zt()+t]},bt=(e,t,a)=>{let s=[];for(let n=0;n<e.items.length;n++){let[,o,r]=e.items[n];t===o&&a===r&&s.push(e.items[n])}return s},It=(e,t,a,s)=>{let{items:n}=e;for(let e=0;e<n.length;e++){let[o,r,i]=n[e];if(a===r&&s===i&&t===et(at(o)))return n.splice(e,1),!0}return!1},Nt=(e,t)=>{let a=[],[s,n]=we(t);for(let t=-1;t<=1;t++)for(let o=-1;o<=1;o++)a=a.concat(bt(e,s+o,n+t));return a},wt=(e,t)=>{let a=((e,t)=>{let a=[],[s,n]=we(t);for(let o=-1;o<=1;o++)for(let r=-1;r<=1;r++){let i=pt(e,s+r,n+o);i&&i!==t&&(a=a.concat([i]))}return a})(e,t),[s,n]=we(t);return[[-2,0],[2,0],[0,-2],[0,2]].forEach(([o,r])=>{let i=pt(e,s+o,n+r);i&&i!==t&&a.push(i)}),a},vt=(e,t,a)=>!!e.visMap[a][t],kt=(e,t,a)=>!!e.explMap[a][t],At=(e,t)=>{xt(t);for(let a=0;a<e.length;a++){let[s,n]=e[a];Rt(gt(t,s,n),!0)}},xt=e=>{for(let t=0;t<e.tiles.length;t++)Rt(e.tiles[t],!1)},St=e=>(null==e?void 0:e[1])||0,Ct=e=>!ma.includes(St(e)),Et=e=>pa.includes(St(e)),Bt=e=>ba.includes(St(e)),Tt=e=>{((e,t)=>{e&&(e[0]="terrain1_"+t,e[1]=t)})(e,St(e)+1)},Rt=(e,t)=>{e&&(e[4]=t)},Mt=null,Ht=!1,_t=!1,Dt=-1,Lt=null,Ot=null,Wt=!1,Pt=null,Ft=[],jt=!1,Gt=!1,zt={visible:!1,text:"",title:"ALERT",portrait:""},Yt=e=>jt=e,qt=e=>Gt=e,Ut=()=>2,Vt=e=>Mt=e,Jt=()=>Mt,Zt=()=>64,Kt=()=>16,Qt=()=>Ht,Xt=e=>Ht=e,$t=e=>Lt=e,ea=()=>Lt,ta=e=>_t=e,aa=()=>_t,sa=e=>Dt=e,na=()=>sa(-1),oa=()=>Ot,ra=()=>Ft,ia=()=>Wt,la=e=>Wt=e,ca=e=>{Pt=e},ha=()=>zt,ua=e=>{let t=e.player,[a,s]=dt(t);return e.rooms[4*s+a]},da={Player:0,SmallBandit:2,Archer:4,Bandit:6,BanditMage:8,Dockmaster:10,BanditLeader:12,Idoreo:14,Noble:16,Crate:18,Barrel:19,Radmila:20,Townsman1:22,Townsman2:24,Townswoman1:26,Townswoman2:28,GuardBlackrose:30,GuardRealm:32,GuardNeutral:34,Dunns:36,Elvyosa:38,SignPost:40,Sign:41,Merchant:42,SmallGolem:44,Golem:46,Sol:48,Mullen:50,Chem:52,Bartolo:54,AldebethBlackrose:56,PlayerUnequipped:58,PlayerKnife:60,PlayerSpear:62,PlayerBow:64},ya={Radmila:"portrait1_0",Dunns:"portrait1_3",AldebethBlackrose:"portrait1_6",Sol:"portrait1_9",Mullen:"portrait1_12",Idoreo:"portrait1_15",Chem:"portrait1_18",Sign:"portrait1_21"},ma=[1,2,3,4,5,7,8,9,12,14,15,16,24,25,26,30,35,36,39,40,41,42,43,44,45,46,52,53,54,55,56,57,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,87,88,89,90,91,92,93,94,95,96,97,98,99,102,103,104,105,106,107,108,109,110,111,112,113,114],pa=[1,2,3,4,5,8,9,12,14,24,25,26,39,40,41,52,53,54,55,56,57,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,87,88,89,90,91,92,93,94,95,96,97,98,99],fa=[0,0,0,0,0,0,17,17,17,18,18,18,19,20,21],ga=[63,63,63,63,63,64,64,65,65,66,67],ba=[5,59],Ia={Grass:0,Chest:14,Water:15,CaveFloor:63},Na={spriteIndex:0,spriteSheet:"actors1",name:"Actor",stats:de(100),behavior:0,talkTrigger:"",talkPortrait:"",stepTrigger:"",dropLevel:0,facing:ue,actorType:0},wa=e=>{let{name:t,spriteIndex:a,meta:s,sellAmount:n,equipState:o}=e;return[a,t,s||{},n||0,o||Ze]},va=a({spriteIndex:da.Barrel}),ka=a({spriteIndex:da.Crate}),Aa=async(e,t,a,s,n,o)=>{if(o=o||await(async e=>new Promise(t=>{ta(!0),Ot=e,$t((e,a)=>{e>-1&&a>-1?(cs(),na(),t([e,a])):t(null),$t(null),b()})}))(a)){let r=Jt(),[i,l]=o,h=c(i,l,a),u=!1;for(let a=0;a<h.length;a++){let[o,i]=h[a],l=pt(ua(r),o,i);l&&0===e&&(d(t,l,s,u?"":n,r),u=!0)}return u?(D(),!0):(Qa("cancel"),!1)}return!1},xa=(e,t)=>()=>(Qa("gold"),((e,t)=>{e.gold+=t})(Jt().player,h(e,t)),!1),Sa=(wa({name:"Gold S",spriteIndex:13,meta:{onAcq:xa(1,5)},sellAmount:1}),wa({name:"Gold S",spriteIndex:13,meta:{onAcq:xa(1,5)},sellAmount:1}),wa({name:"Gold S",spriteIndex:13,meta:{onAcq:xa(5,10)},sellAmount:1}),wa({name:"Rusty Knife",spriteIndex:2,meta:{getDmg:()=>[4,8]},sellAmount:1,equipState:Qe})),Ca=wa({name:"Rusty Sword",spriteIndex:2,meta:{getDmg:()=>[8,16]},sellAmount:1,equipState:Ke}),Ea=wa({name:"Rusty Spear",spriteIndex:2,meta:{getDmg:()=>[12,14]},sellAmount:1,equipState:Xe}),Ba=wa({name:"Rusty Bow",spriteIndex:7,meta:{getDmg:()=>[1,2],onUse:async e=>Aa(0,e,0,[13,20],"flame")},sellAmount:1,equipState:$e}),Ta=(wa({name:"Wood-tipped Arrow",spriteIndex:1,meta:{onUse:async e=>Aa(0,e,0,[13,20],"flame")},sellAmount:1}),wa({name:"Scroll: Flame",spriteIndex:6,meta:{onUse:async e=>Aa(0,e,0,[13,20],"flame")},sellAmount:50}),wa({name:"Potion: Health",spriteIndex:9,meta:{onUse:async e=>(He(fe(e),h(5,15)),!0)},sellAmount:50})),Ra=t({spriteIndex:da.Dockmaster,spriteSheet:"actors1",name:"Dock Master",stats:de(100),behavior:0,talkTrigger:"Alinea_CH_DockmasterClaire",stepTrigger:"",dropLevel:0,facing:ue,talkPortrait:""}),Ma=t({spriteIndex:da.Bartolo,spriteSheet:"actors1",name:"Noble",stats:de(100),behavior:0,talkTrigger:"Alinea_CH_BartoloCaldeburn",stepTrigger:"",dropLevel:0,facing:he,talkPortrait:""}),Ha=(t({spriteIndex:da.AldebethBlackrose,spriteSheet:"actors1",name:"Noble",stats:de(100),behavior:0,talkTrigger:"Alinea_CH_AldebethBlackrose",stepTrigger:"",dropLevel:0,facing:he,talkPortrait:""}),t({spriteIndex:da.Sol,spriteSheet:"actors1",name:"Strange Man",stats:de(100),behavior:0,talkTrigger:"Alinea_CH_Sol",stepTrigger:"",dropLevel:0,facing:ue,talkPortrait:ya.Sol})),_a=t({spriteIndex:da.Townsman1,spriteSheet:"actors1",name:"Bartender",stats:de(100),behavior:0,talkTrigger:"Alinea_CH_BartenderRus",stepTrigger:"",dropLevel:0,facing:he,talkPortrait:""}),Da=t({spriteIndex:da.GuardRealm,spriteSheet:"actors1",name:"Guard",stats:de(250),behavior:1,talkTrigger:"",stepTrigger:"",dropLevel:0,facing:he,talkPortrait:""}),La=t({spriteIndex:da.GuardRealm,spriteSheet:"actors1",name:"Guard",stats:de(250),behavior:0,talkTrigger:"",stepTrigger:"",dropLevel:0,facing:he,talkPortrait:""}),Oa=t({spriteIndex:da.Mullen,spriteSheet:"actors1",name:"Realm Captain",stats:de(250),behavior:0,talkTrigger:"Alinea_CH_GuardCaptainMullen",stepTrigger:"",dropLevel:0,facing:ue,talkPortrait:ya.Mullen}),Wa=s({text:"REALM EMBASSY\n See Lieutenant Mullen for duties."}),Pa=s({text:"THE STONE BARREL\n Sweets and Craft Ale"}),Fa=s({text:'WELCOME TO ALINEA!\nOn arrival, please report to Dockmaster Claire for a permit and warehouse options.\n(At the bottom of the sign is a hastily-written note.)\n"Guys... Be sure to tie your mooring lines tightly!  We don\'t need any more fiascos like last week."',spriteIndex:da.SignPost}),ja=s({text:"WAREHOUSE 1."}),Ga=s({text:"WAREHOUSE 2."}),za=s({text:"WAREHOUSE 3."}),Ya=s({text:"WAREHOUSE 4."}),qa=s({text:"WAREHOUSE 5."}),Ua=s({text:"WAREHOUSE 6."}),Va=s({text:"WAREHOUSE 7."}),Ja=s({text:'(This sign is scratched and rusted, but you can make out a single character.) "9".'}),Za={talk:[.6,0,326,.08,,.07,1,.25,,33,-111,.01,,,2.9,.8,.06,.22,.05,.01],talkEnd:[.6,0,326,.08,,.07,1,.15,.1,33,-111,.01,,,2.9,.6,.05,.52,.05,.01],buyItem:[,,182,.03,,.07,1,.01,-66,-35,-869,.14,.12,.8,,,.16,.38,,.04],sellItem:[,,8,.04,,.19,2,.4,,.1,607,.19,,.4,1.6],pickupItem:[,,756,.12,.08,.13,4,2.35,55,,,,.15,,,,,.36,,.04],btn:[,,53,.01,,0,,.73,-35.4,,684,.01,.6,.2,-.4,,.51,.11,.03],btn2:[1.5,0,834,,.01,,,.01,,,356,,.18,,,.1,.07,.01,.01],btnCancel:[,0,272,.02,.13,0,2,.83,-6.5,,-17,,,,,,.04,.37,.04],eqp:[2.01,,1509,.05,.03,.06,4,1.51,,-.2,827,.02,,,81,.1,.09,.14,.05],hitSpell1:[2.4,0,606,,,.12,1,.68,-31,-5.1,,,.06,,,.1,.17,,.06,.3],hitSpell2:[,,807,,.13,0,3,.66,-13,-24,,,,,,.5,.18,,.25],alert:[.3,0,398,.02,.01,.04,1,.29,.1,,959,.08,,,,,.04,.25,.22],alertMinor:[.3,,0,.05,,.02,2,1.76,5.3,,,,,,,.1,,.68,.05,.19],alertEvent:[.8,0,174.6141,.03,.13,.09,3,.92,,,-65,.06,,.1,,,,.37],alertEvent2:[,0,365,,.02,.31,1,1.08,,,,,,.9,-303,.1,,.53,,.23],bless:[.3,0,1809,.11,.22,.11,,.05,,,46,.03,,,,,,.14,.21,.01],dyingGolem:[,0,53,.11,.21,.01,2,.53,,,,,.44,,-.1,.9,.49,.27,.17],dyingFairy:[.5,0,918,,.16,.01,1,.47,,49,58,.06,.01,.2,-2.9,,,,.16],dyingGoblin:[.3,-.05,1598,.06,.19,.01,4,.27,.5,.2,,,,,,,,,.01],projectileBow:[,,8,.06,,0,4,.04,,,-40,.02,.03,.7,,,.37,,.02,.1],projectileBow2:[.5,0,450,.06,.01,.21,,1.79,9.9,-38,541,.06,.05,,3.8,.2,,.31,.01],projectileCast:[.3,,1983,.16,,.03,4,2.51,,-43,,,,,,.8,,.03,.17,.01],castSpellCharge:[1.5,,723,.16,.17,.13,3,1.29,40,-.1,,,.33,,.1,.4,.08,,,.98],levelUp:[.6,0,1250,.02,,,3,1.52,-4.2,13,234,.06,.04,,,,.06,,.2,.27],levelUp2:[,0,88,,,.19,1,2.55,,2,235,.02,.14,,3.2,,.32,.53,.18],gainRenown:[.5,,6,.1,,.05,2,0,,.1,471,,.03,,1,,.08,.74,.01,.38],unlockDoor:[.3,0,1727,,,.14,1,2.66,.4,28,-517,.03],stepGrass:[,,1266,.1,,.03,4,1.96,,91,,,,,.7,.2,.11],stepFloor:[,,207,.04,,0,4,1.25,-.3,91,-21,.01,,,,.1,.03,.32],magHit:[,,1512,,,.21,1,.22,6.3,,,,,.4,-3.6,,.23,,.13],magHit2:[.4,,753,.1,,.05,2,1.71,27,,24,.07,,,5.3,.1,,,.13],lava:[,,53,.1,.08,.05,3,.12,-9.1,.4,,,.04,.3,-2.4,,,,.05,.54],doorOpen:"snd/door-open.mp3"},Ka=async()=>{let e=[];for(let t in Za){let a=Za[t];"string"==typeof a&&e.push(new Promise((e,s)=>{let n=""+a,o=new Audio(n);o.autoplay=!1,o.oncanplay=()=>{o.oncanplay=null,o.currentTime=99999999999;let a=o.currentTime;o.currentTime=0,o.onended=function(){o.pause(),o.currentTime=0},Za[t]={sound:o,audio:o,soundDuration:a},e()},o.addEventListener("error",e=>{console.error(e),s('Cannot load sound: name="'+t+'", url="'+n+'"')}),o.src=n}))}await Promise.all(e)},Qa=e=>{let t=Za[e];if(t)if(t.length)ce=.3,((e=1,t=.05,a=220,s=0,n=0,o=.1,r=0,i=1,l=0,c=0,h=0,u=0,d=0,y=0,m=0,p=0,f=0,g=1,b=0,I=0)=>{let N,w,v=2*Math.PI,k=l*=500*v/44100**2,A=(0<m?1:-1)*v/4,x=a*=(1+2*t*Math.random()-t)*v/44100,S=[],C=0,E=0,B=0,T=1,R=0,M=0,H=0;for(c*=500*v/44100**3,m*=v/44100,h*=v/44100,u*=44100,d=44100*d|0,w=(s=99+44100*s)+(b*=44100)+(n*=44100)+(o*=44100)+(f*=44100)|0;B<w;S[B++]=H)++M%(100*p|0)||(H=r?1<r?2<r?3<r?Math.sin((C%v)**3):Math.max(Math.min(Math.tan(C),1),-1):1-(2*C/v%2+2)%2:1-4*Math.abs(Math.round(C/v)-C/v):Math.sin(C),H=(d?1-I+I*Math.sin(2*Math.PI*B/d):1)*(0<H?1:-1)*Math.abs(H)**i*e*ce*(B<s?B/s:B<s+b?1-(B-s)/b*(1-g):B<s+b+n?g:B<w-f?(w-B-f)/o*g:0),H=f?H/2+(f>B?0:(B<w-f?1:(w-B)/f)*S[B-f|0]/2):H),N=(a+=l+=c)*Math.sin(E*m-A),C+=N-N*y*(1-1e9*(Math.sin(B)+1)%2),E+=N-N*y*(1-1e9*(Math.sin(B)**2+1)%2),T&&++T>u&&(a+=h,x+=h,T=0),!d||++R%d||(a=x,l=k,T=T||1);(e=zzfxX.createBuffer(1,w,44100)).getChannelData(0).set(S),(a=zzfxX.createBufferSource()).buffer=e,a.connect(zzfxX.destination),a.start()})(...t);else{let e=function(e){let t=Object.assign(Object.assign({},e),{audio:e.audio.cloneNode(),soundName:name,duration:0,isPlaying:!1,isPaused:!1});return t.sound=t.audio,t}(t),{sound:a}=e;a.volume=.3,a.play(),t.lastStartTimestamp=performance.now(),t.isPlaying=!0}else console.error("No sound exists with name: "+e)},Xa={font:"monospace",color:"#fff",size:14,align:"center",strokeColor:"black"},$a=()=>{let e=qe();as(0,0,e.width,e.height,"black")},es=(e,t)=>{(t=t||Ue()).globalAlpha=e},ts=(e,t,a,s,n)=>{s=s||1,n=n||Ue();let o="string"==typeof e?Fe[e]:e;if(!o)throw Error(`Cannot find sprite with name: "${e}"`);let[r,i,l,c,h]=o;n.drawImage(r,i,l,c,h,t,a,c*s,h*s)},as=(e,t,a,s,n,o,r)=>{(r=r||Ue())[o?"strokeStyle":"fillStyle"]=n,r[o?"strokeRect":"fillRect"](e,t,a,s)},ss=(e,t,a,s,n)=>{let{font:o,size:r,color:i,align:l,strokeColor:c}=Object.assign(Object.assign({},Xa),s||{});(n=n||Ue()).font=`${r}px ${o}`,n.textAlign=l,n.textBaseline="middle",c&&(n.strokeStyle=c,n.lineWidth=4,n.strokeText(e,t,a)),n.fillStyle=i,n.fillText(e,t,a)},ns=(e,t,a,s,n)=>{let[o,r]=we(e),[i,l]=t,c=pe(e),h=Kt()*a;ts(c,s+o*h-i*h,n+r*h-l*h,a)},os=(e,t,a,s,n)=>{a=a||1;let[o,,,r,i,l]=e,c=Kt(),h=c*a/2,u=c*a,[d,y]=t,m=s+r*u-d*u,p=n+i*u-y*u;if(o&&ts(o,m,p,a),l){let e=Ue();e.font="16px monospace",e.fillStyle="#FFF",e.fillText(l,m+h-(2===l.length?9:5),p+h+5)}},rs=(e,t,a,s,n,o,r)=>{let i=tt(e),[l,c]=t,h=Kt()*n;ts(i,o+a*h-l*h+8,r+s*h-c*h+8,n-1)},is=(e,t)=>{let a=Kt(),s=e.player,[n,o]=dt(s),r=a*t,i=e.rooms[4*o+n],l=ut(s),c=(e=>{let t=ut(e.player),a=Zt(),[s,n]=we(t),o=[s-8,n-8,17,17];return o[0]<0?o[0]=0:o[0]+o[2]>=a&&(o[0]=a-o[2]),o[1]<0?o[1]=0:o[1]+o[3]>=a&&(o[1]=a-o[3]),o})(e),[h,u,d,y]=c,m=wt(i,l);for(let e=0;e<y;e++)for(let a=0;a<d;a++){let s=h+a,n=u+e,[o,,l,c]=i.tiles[64*n+s],d=l*r-h*r,y=c*r-u*r;kt(i,l,c)?(ts(o,d,y,t),vt(i,l,c)||(es(.15),as(d,y,r,r,"black",!1),es(1))):as(d,y,r,r,"black",!0)}for(let e in i.items){let[a,s,n]=i.items[e],o=at(a);vt(i,s,n)&&rs(o,c,s,n,t,0,0)}for(let e in i.actors){let a=i.actors[e],[s,n]=we(a);kt(i,s,n)&&(0!==Oe(a)||vt(i,s,n))&&ns(a,c,t,0,0)}ns(l,c,t,0,0);for(let e in i.tiles){let[,,t,a,s]=i.tiles[e],n=t*r,o=a*r;s&&as(n,o,r,r,"#ccc",!0)}for(let e=0;e<i.p.length;e++)os(i.p[e],c,t,0,0);for(let e=0;e<m.length;e++){let t=m[e],[a,s]=we(t),n=a*r,o=s*r,i=me(t);(Le(t)||i)&&ss(i,n-h*r+r/2,o-u*r-8,{color:0===e?"#F7E26B":"white"})}},ls=(e,t,a,s)=>{let n=ys("tgt");ms(n,{display:"block"});let o=n.children[0];o.setAttribute("x1",""+e),o.setAttribute("x2",""+a),o.setAttribute("y1",""+t),o.setAttribute("y2",""+s)},cs=()=>{ta(!1),ms(ys("tgt"),{display:"none"})},hs=()=>{let e=Jt(),t=ys("rightPane"),a=ys("leftPane"),s=ys("dialog"),n=ys("alert");ms(t,{width:""}),o(a,ks(e)),o(t,As(e)),o(s,Ns()),o(n,Is()),ms(document.body.children[0],{display:"flex"})},us={},ds={},ys=e=>document.getElementById(e),ms=(e,t)=>{for(let a in t)e.style[a]=t[a]},ps=e=>{let t=us[e];if(!t){let[a,s]=Ye(32,32);ts(e,0,0,2,s),t=a.toDataURL(),us[e]=t}return t},fs=(e,t,a)=>{a=a||1,t=t||16;let s=ds[e];if(!s){let[n,o]=Ye(t*a,t*a);ts(e,0,0,a,o),s=n.toDataURL(),ds[e]=s}return s},gs=!1,bs=e=>{if(13===e.which||32===e.which){let e=document.getElementById("alert-confirm-btn");e&&(e.className+=" btn-active",Qa("btn"),setTimeout(()=>{W()},100))}},Is=()=>{let e=ha(),t=e.visible,a=e.text.split("\n"),s=e.portrait,n=2,o=32;s||(s="actors1_0",n=3,o=16);let i=fs(s,o,n);if(t)gs||(gs=!0,window.addEventListener("keydown",bs));else{gs=!1,window.removeEventListener("keydown",bs);let e=document.getElementById("alert-confirm-btn");e&&(e.className="btn")}return r("div",{style:{position:"fixed",left:0,top:0,height:"100%",width:"100%",display:t?"flex":"none","justify-content":"center","align-items":"center"}},r("div",{style:{width:"400px",background:"#493C2B",border:"4px outset #9d9d9d"}},r("div",{className:"title"},e.title||"ALERT"),r("div",{style:{display:"flex","justify-content":"space-between"}},r("div",{style:{width:"64px"}},r("img",{style:{background:"#CCCCCC","margin-left":"16px","margin-top":"16px"},src:i})),r("div",{style:{width:"calc(100% - 64px - 16px - 16px - 16px - 16px)",border:"2px inset",background:"#656d71",padding:"8px",margin:"16px","min-height":"44px"}},a.map((e,t)=>r("div",{style:{"margin-bottom":"7px"},key:t},e)))),r("div",{style:{display:"flex","justify-content":"flex-end"}},r("div",{className:"btn",id:"alert-confirm-btn",onclick:()=>{Qa("btn"),setTimeout(()=>{W()},100)},style:{"min-width":"80px",background:"#656d71",margin:"4px 16px"}},"OK"))))},Ns=()=>{let e=ra(),t=ia(),a=Pt,s=(e=>(null==e?void 0:e[16])||"")(a),n=4,o=32;s||(s=a?pe(a):"actors1_0",n=4,o=16);let i=fs(s,o,n);return r("div",{style:{height:t?"100%":"0px",opacity:t?"1":"0"}},r("div",{className:"dialog-bg",style:{opacity:t?"1":"0"}}),r("div",{className:"title"},"DIALOG"),r("div",{className:"dialog-portrait hrz"},r("img",{style:{margin:"2px",background:"#CCCCCC",padding:"5px",border:"2px outset white"},src:i})),e.map(({text:e,color:t,cb:a})=>r("div",{className:"dialog-line"+(a?" dialog-line-choice":""),style:{color:t||""},onclick:()=>{a&&a()}},e)))},ws=0,vs=(e,t,a)=>{if(!e)return r("div",{className:"item hrz"});let s=at(e),n=st(e),o=et(s),i=tt(s),l=ps(i),c=ke(a)===e,h=e=>()=>{let s=a[12],n=((e,t,a)=>{let s=e+a;if(s<0||s>=t.length)return e;let n=t[e];return t[e]=t[e+a],t[e+a]=n,e+a})(t,ge(a),e),o=s;n===s&&(o=s-e),c&&(o=t+e),Ae(a,o),hs()},u=[];return ot(e)&&u.push(r("div",{className:"menu-item",onclick:async()=>{sa(t),N(s,a)}},"USE")),lt(e)&&!c&&u.push(r("div",{className:"menu-item",onclick:async()=>{w(t,a)}},"EQP")),r("div",{className:"item hrz",style:{"justify-content":"flex-start",background:t===Dt?"#444":"unset"}},r("div",{className:"vrt menu-item-ctr"},r("div",{className:"cyc-item",onclick:h(-1)},"up"),r("div",{className:"cyc-item",onclick:h(1)},"dn")),r("div",{style:{margin:"5px",width:"20px"}},t+1+". "),r("div",{className:"vrt menu-item-ctr"},u),r("img",{style:{margin:"2px"},src:l}),r("div",{style:{color:c?"#9ef":"unset"}},`${o} ${n>1?"("+n+")":""}`))},ks=e=>{let t=jt;return r("div",{id:"leftPane"},(e=>{let t=ut(e),a=ge(t),s=[],n=ia();for(let e=0;e<24;e++)s.push(vs(a[e],e,t));return r("div",{id:"invDiv"},r("div",{className:"inventory",onscroll:e=>{var t;ws=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.scrollTop},scrollTop:ws},r("div",{className:"title"},"INVENTORY"),s),r("div",{className:"overlay",style:{width:n?"100%":"0"}}))})(e.player),r("div",{className:"overlay",style:{left:0,width:t?"100%":"0"}}))},As=e=>{let t=Gt;return r("div",null,r("div",{className:"ctrl info-item hrz"},r("div",{id:"reset-item",className:"menu-item",style:{width:"80px"},onclick:()=>l()},"Reset")),r("div",{className:"ctrl info-item",style:{height:"100px"}}),r("div",{className:"pickup info-item",scrollTop:0},((e,t)=>{let a=ut(e),s=Nt(t,a);return r("div",null,r("div",{className:"title"},"NEARBY ITEMS"),s.map(([e,s,n],o)=>((e,t,a,s,n,o)=>{if(!e)return r("div",{key:t,className:"item hrz",style:{width:"155px",background:"#555"}});let i=at(e),l=st(e),c=et(i),h=tt(i),u=ps(h);return r("div",{key:c+t,className:"item hrz",style:{width:"155px",background:"#555","justify-content":"flex-start"},onclick:()=>v(e,o,s,n,a)},r("span",null,"!@#$%^&*()_+"[t]+"."),r("img",{src:u}),r("span",null,`${c} ${l>1?"("+l+")":""}`))})(e,o,t,s,n,a)))})(e.player,ua(e))),r("div",{className:"overlay",style:{right:0,width:t?"100%":"0"}}))}})();